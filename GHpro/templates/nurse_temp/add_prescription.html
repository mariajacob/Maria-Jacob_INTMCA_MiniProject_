{% comment %} <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Prescription</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="{% static 'assets/css/bootstrap.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'assets/css/style.css' %}">
</head>
<body> {% endcomment %}
    {% load static %}
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0">
        <link rel="shortcut icon" type="image/x-icon" href="{% static 'images/favicon.ico' %}">
        <title>Create Prescription - GentleHaloes Admin Dashboard</title>
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="{% static 'assets/css/bootstrap.min.css' %}">
        <link rel="stylesheet" type="text/css" href="{% static 'assets/css/font-awesome.min.css' %}">
        <link rel="stylesheet" type="text/css" href="{% static 'assets/css/style.css' %}">
    </head>
    <body>
    <div class="main-wrapper">
        <div class="header">
            <div class="header-left">
                <a href="{% url 'nurse_index' %}" class="logo">
                    <img src="{% static 'images/ghbc1.png' %}" width="100" height="55" alt=""><span>GentleHaloes</span>
                </a>
            </div>
             <a id="toggle_btn" href="javascript:void(0);"><i class="fa fa-bars"></i></a>
            <a id="mobile_btn" class="mobile_btn float-left" href="#sidebar"><i class="fa fa-bars"></i></a>
            <ul class="nav user-menu float-right">
                <li class="nav-item dropdown has-arrow">
                    <a href="#" class="dropdown-toggle nav-link user-link" data-toggle="dropdown">
                        <i class="fa fa-user" aria-hidden="true"></i>
                        <span>{{ user.email }}</span>
                    </a>
                    {% if user.is_authenticated %}
                    <div class="dropdown-menu">
                        
                        <a class="dropdown-item" href="{% url 'loggout' %}">Logout</a>
                    </div>
                    {% else %}
                    <div class="dropdown-menu">
                        <a class="dropdown-item" href="{% url 'login_page' %}">Login</a>
                    </div>
                    {% endif %}
                </li>
            </ul>
        </div> 
        <div class="sidebar" id="sidebar">
            <div class="sidebar-inner slimscroll">
                <div id="sidebar-menu" class="sidebar-menu">
                    <ul>
                        <li class="menu-title">Main</li>
                        <li class="active">
                            <a href="{% url 'nurse_index' %}"><i class="fa fa-dashboard"></i> <span>Dashboard</span></a>
                           
                        </li> 
                       
                         <li>
                            <a href="{% url 'patient_list_nurse' %}"><i class="fa fa-user"></i> <span>Patient List</span></a>
                        </li>
                       <li>
                            <a href="{% url 'add_prescription' %}"><i class="fa fa-user"></i> <span>Add Prescription</span></a>

                        </li> 
                        <li>
                            <a href="{% url 'view_prescription_nurse' %}"><i class="fa fa-user"></i> <span> View Prescription</span></a>

                        </li> 
                        <li>
                            <a href="{% url 'nurse_approved_appo' %}"><i class="fa fa-calendar"></i> <span>Appointments</span></a>
                        </li>
                        
                        <li>
                            <a href="{% url 'view_leave' %}"><i class="fa fa-calendar" id="leaveind"></i> <span>View Leave</span></a>
                        </li>
                        <li>
                            <a href="{% url 'add_view_rec_nurse' %}"><i class="fa fa-calendar"></i> <span>Add Medical Record</span></a> 
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="page-wrapper">
            <div class="container mt-5">
                <div class="card">
                    <div class="card-header">
                        <h2 class="text-center">Create Prescription</h2>
                    </div>
                    <div class="card-body">
                        <form method="post">
                            {% csrf_token %}
                            

                            
                            <div class="form-group row">
                                <label for="patient_id" class="col-sm-3 col-form-label">Patient:</label>
                                <div class="col-sm-9">
                                    <select name="patient_id" id="patient_id" class="form-control">
                                        <option value="Choose Patient">Choose Patient</option>
                                        {% for patient in patients %}
                                            <option value="{{ patient.id }}">{{ patient.first_name }} {{ patient.last_name }} , {{ patient.house_name }} , House No: {{ patient.house_no }} </option>
                                        {% endfor %}
                                    </select>
                                    <br>
                                    <button type="button" id="viewPastPrescriptionsBtn" class="btn btn-secondary">View Past Prescriptions</button>  
                                </div>
                                
                            </div>

                            {% comment %} <button type="button" id="viewPastPrescriptionsBtn" class="btn btn-secondary">View Past Prescriptions</button> {% endcomment %}
                            
                            <div id="pastPrescriptionsContainer"></div>
                            {% comment %} <div class="form-group row">
                                <label for="medicine" class="col-sm-3 col-form-label">Medicine:</label>
                                <div class="col-sm-9">
                                    <select name="medicine" id="medicine" class="form-control">
                                        <option value="Choose Medicine">Choose Medicine</option>
                                        {% for medicine in medicines %}
                                            <option value="{{ medicine.id }}">{{ medicine.medicineName }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                             {% endcomment %}
                             <div class="form-group row">
                                <label for="medicines" class="col-sm-3 col-form-label">Medicine:</label>
                                <div class="col-sm-9">
                                    {% for medicine in medicines %}
                                    <br> <br> 
                                    <div class="form-check">
                                        <input type="checkbox" name="medicines" id="medicine_{{ medicine.id }}" value="{{ medicine.id }}">
                                        <label class="form-check-label" for="medicine_{{ medicine.id }}">{{ medicine.medicineName }}</label>
                                        <!-- Input fields for individual attributes -->
                                        <br> <br> 
                                        <div class="row">
                                            <div class="col-sm-2">
                                                <input type="text" name="morning_{{ medicine.id }}" class="form-control" placeholder="Morning">
                                            </div>
                                            <div class="col-sm-2">
                                                <input type="text" name="noon_{{ medicine.id }}" class="form-control" placeholder="Noon">
                                            </div>
                                            <div class="col-sm-2">
                                                <input type="text" name="evening_{{ medicine.id }}" class="form-control" placeholder="Evening">
                                            </div>
                                            <div class="col-sm-2">
                                                <input type="text" name="quantity_{{ medicine.id }}" class="form-control" placeholder="Quantity">
                                            </div>
                                            <div class="col-sm-2">
                                                <input type="text" name="duration_{{ medicine.id }}" class="form-control" placeholder="Duration">
                                            </div>
                                            <div class="col-sm-2">
                                                <input type="text" name="dosages_{{ medicine.id }}" class="form-control" placeholder="Dosages">
                                            </div>
                                        </div>
                                    </div>
                                    {% endfor %}
                                </div>
                            </div>

                            <br> <br> 

                            <div class="form-group row">
                                <label for="date_of_prescription" class="col-sm-3 col-form-label">Date of Prescription:</label>
                                <div class="col-sm-9">
                                    <input type="date" name="date_of_prescription" id="date_of_prescription" class="form-control" max="{% now "Y-m-d" %}">
                                </div>
                            </div>
                            
                           
                            <div class="form-group row">
                                <div class="col-sm-12">
                                    <button type="submit" class="btn btn-primary btn-block">Submit</button>
                                </div>
                            </div>
                        </form>
                        
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        document.getElementById('viewPastPrescriptionsBtn').addEventListener('click', function() {
            var patientId = document.getElementById('patient_id').value;
            var xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function() {
                if (xhr.readyState === XMLHttpRequest.DONE) {
                    if (xhr.status === 200) {
                        document.getElementById('pastPrescriptionsContainer').innerHTML = xhr.responseText;
                    } else {
                        console.error('Error fetching past prescriptions:', xhr.status);
                    }
                }
            };
            xhr.open('GET', '/view_past_prescriptions?patient_id=' + patientId);
            xhr.send();
        });
    </script>
    {% comment %} <script>
        document.getElementById('viewPastPrescriptionsBtn').addEventListener('click', function() {
            var patientId = document.getElementById('patient_id').value;
            window.location.href = '/view_past_prescriptions?patient_id=' + patientId;
        });
    </script> {% endcomment %}
    
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>

    <style>
        /* Style to move the button to the right side */
        #viewPastPrescriptionsBtn {
            float: right;
            margin-right: 30px; /* Adjust margin as needed */
        }
    
        /* Style to change the button color to green */
        #viewPastPrescriptionsBtn {
            background-color: green;
            border-color: green;
            color: white;
        }
    </style>
    </body>
    </html>
    